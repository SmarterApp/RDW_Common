package org.opentestsystem.rdw.archive;

/**
 * ArchiveService factory method.
 */
public class ArchiveServiceFactory {

    /**
     * Create {@link ArchiveService} based on root.
     * The root is expected to be of the form "file:///tmp/" or "s3://bucket"
     *
     * @param archiveRoot archive root
     * @return newly created {@link ArchiveService}
     * @throws IllegalArgumentException if root is invalid or not found
     */
    public static ArchiveService newInstance(final String archiveRoot) {
        if (LocalArchiveService.validRoot(archiveRoot)) {
            return new LocalArchiveService(archiveRoot);
        }
        if (S3ArchiveService.validRoot(archiveRoot)) {
            return new S3ArchiveService(archiveRoot);
        }
        throw new IllegalArgumentException("Invalid archive root " + archiveRoot);
    }
}
