buildscript {
  repositories {
    mavenLocal()
    jcenter()
    maven { url 'http://repo.spring.io/plugins-release' }
  }
  dependencies {
    classpath("io.spring.gradle:dependency-management-plugin:1.0.0.RELEASE")
    classpath("org.springframework.boot:spring-boot-gradle-plugin:1.5.2.RELEASE")
    classpath('org.springframework.build.gradle:propdeps-plugin:0.0.7')
  }
}

apply plugin: 'io.spring.dependency-management'

allprojects {
    group = 'org.opentestsystem.rdw.common'
    version = '1.0.0-SNAPSHOT'

    apply plugin: 'idea'
    apply plugin: 'propdeps'
    apply plugin: 'propdeps-maven'
    apply plugin: 'propdeps-idea'

    if (project.hasProperty("buildNumber")) {
      project.setVersion(project.version.toString().replaceAll("SNAPSHOT", "${buildNumber}"))
    }
}

subprojects {
  apply plugin: "java"
  apply plugin: "maven"
  apply plugin: "jacoco"
  apply plugin: 'io.spring.dependency-management'

  sourceCompatibility = 1.8
  targetCompatibility = 1.8

  repositories {
      mavenCentral()
  }

  dependencyManagement {
    dependencies {
      // commonly used libraries
      dependency 'com.google.guava:guava:21.0'
      dependency 'org.slf4j:slf4j-api:1.7+'

      // commonly used test libraries
      dependency 'junit:junit:4.12+'
      dependency 'org.assertj:assertj-core:3.6+'
      dependency 'org.mockito:mockito-core:1.10+'
    }
    imports {
      // make springframework versions consistent with other projects in the RDW suite
      mavenBom 'org.springframework.boot:spring-boot-dependencies:1.5.2.RELEASE'
      mavenBom 'org.springframework.cloud:spring-cloud-dependencies:Camden.SR5'
    }
  }

  dependencies {
    compile 'org.slf4j:slf4j-api'

    testCompile 'junit:junit'
    testCompile 'org.mockito:mockito-core'
    testCompile 'org.assertj:assertj-core'
  }

  jacoco {
    toolVersion = "0.7.6.201602180812"
  }
  test.finalizedBy jacocoTestReport

  task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
  }

  task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
  }

  artifacts {
    archives sourcesJar
    archives javadocJar
  }
}
  

