package org.opentestsystem.rdw.multitenant;

import java.util.Optional;

/**
 * Strategy pattern to find the current tenantKey.  Tenant keys will be used to find tenant specific values in maps.
 * Provides abstraction from external controlled tenantId and maps to application controlled keys.
 */
public class TenantKeyResolver {

    private TenantProperties tenantProperties;
    private TenantIdResolver tenantIdResolver;

    public TenantKeyResolver(TenantProperties tenantProperties, TenantIdResolver tenantIdResolver) {
        this.tenantProperties = tenantProperties;
        this.tenantIdResolver = tenantIdResolver;
    }

    /**
     * Get the current tenant key.
     *
     * @return tenant key
     */
    public Optional<String> getTenantKey() {
        return tenantIdResolver.getTenantId()
                .flatMap(id -> tenantProperties.findTenantKeyById(id));
    }

}
