package org.opentestsystem.rdw.script;

import org.opentestsystem.rdw.script.publishing.PublishedPipeline;
import org.opentestsystem.rdw.script.publishing.PublishedScript;

import java.util.Collections;
import java.util.Map;

import static com.google.common.collect.ImmutableMap.copyOf;
import static com.google.common.collect.ImmutableMap.of;

/**
 * Exception class for reporting all script compile errors in a pipeline.
 */
public class PipelineBuildException extends RuntimeException {
    private final PublishedPipeline source;
    private final Map<PublishedScript, Exception> errors;

    public PipelineBuildException(final String message,
                                  final PublishedPipeline source,
                                  final Map<PublishedScript, Exception> errors) {
        super(message);
        this.source = source;
        this.errors = errors != null ? copyOf(errors) : of();
    }

    public PublishedPipeline getSource() {
        return source;
    }

    public Map<PublishedScript, Exception> getErrors() {
        return errors;
    }
}
