package org.opentestsystem.rdw.script;

/**
 * Factory class for creating a Pipeline by loading the pipeline definition and then using it to
 * load the script definitions for each node.
 */
public interface PipelineFactory {

    /**
     * Creates a runnable pipeline by loading and compiling the scripts.
     * This will create an effective pipeline based on the published pipeline if present.
     * If there is no published user script this method will still return a pipeline with the tenant-configured base and system scripts
     *
     * @param pipelineCode the name of the pipeline to create
     * @param pipelineVersion the version of the pipeline
     *
     * @return a fully compiled pipeline that can be run against input files
     *
     * @throws PipelineBuildException if any part of the pipeline couldn't be loaded or compiled.
     * @throws java.util.NoSuchElementException if the version is not null and there is no published pipeline corresponding to the provided version
     */
    Pipeline getPipeline(String pipelineCode, String pipelineVersion) throws PipelineBuildException;

    /**
     * Creates an ad-hoc but runnable pipeline for testing a script during development.
     *
     * @param pipelineCode the name of the pipeline to create
     * @param pipelineVersion the version of the pipeline
     * @param scriptBody the code of the user developed script
     *
     * @return a fully compiled pipeline that can be run against input files
     *
     * @throws PipelineBuildException if any part of the pipeline couldn't be loaded or compiled.
     */
    Pipeline getDevelopmentPipeline(
            String pipelineCode,
            String pipelineVersion,
            String scriptBody) throws PipelineBuildException;

}
