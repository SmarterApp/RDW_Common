package org.opentestsystem.rdw.security;


import org.junit.Test;

public class GrantTest {

	@Test(expected = NullPointerException.class)
	public void shouldThrowExceptionWhenConstructedWithoutEntityID() throws Exception {
		Grant.builder()
			.entityId(null)
			.role("role1")
			.entityLevel(Grant.EntityLevel.CLIENT)
			.build();
	}

	@Test(expected = NullPointerException.class)
	public void shouldThrowExceptionWhenConstructedWithoutRole() throws Exception {
		Grant.builder()
			.entityId("client1")
			.role(null)
			.entityLevel(Grant.EntityLevel.CLIENT)
			.build();
	}

	@Test(expected = NullPointerException.class)
	public void shouldThrowExceptionWhenConstructedWithoutEntityLevel() throws Exception {
		Grant.builder()
			.entityId("client1")
			.role("role1")
			.entityLevel(null)
			.build();
	}

	@Test(expected = IllegalArgumentException.class)
	public void shouldThrowExceptionWhenConstructedWithIncorrectEntityIDForLevelClient() throws Exception {
		Grant.builder()
			.entityId("a")
			.role("role1")
			.entityLevel(Grant.EntityLevel.CLIENT)
			.clientId("b")
			.build();
	}

	@Test(expected = IllegalArgumentException.class)
	public void shouldThrowExceptionWhenConstructedWithIncorrectEntityIDForLevelState() throws Exception {
		Grant.builder()
			.entityId("a")
			.role("role1")
			.entityLevel(Grant.EntityLevel.STATE)
			.stateId("b")
			.build();
	}

	@Test(expected = IllegalArgumentException.class)
	public void shouldThrowExceptionWhenConstructedWithIncorrectEntityIDForLevelDistrict() throws Exception {
		Grant.builder()
			.entityId("a")
			.role("role1")
			.entityLevel(Grant.EntityLevel.STATE)
			.districtId("b")
			.build();
	}

	@Test(expected = IllegalArgumentException.class)
	public void shouldThrowExceptionWhenConstructedWithIncorrectEntityIDForLevelInstitution() throws Exception {
		Grant.builder()
			.entityId("a")
			.role("role1")
			.entityLevel(Grant.EntityLevel.STATE)
			.institutionId("b")
			.build();
	}

}
