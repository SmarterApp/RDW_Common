package org.opentestsystem.rdw.security;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import java.io.IOException;

import static org.assertj.core.api.Assertions.assertThat;

public class GroupGrantTest {

    @Test
    public void itShouldPreserveConstructorValues() {
        final GroupGrant groupGrant = new GroupGrant(123L, 4);
        assertThat(groupGrant.getId()).isEqualTo(123);
        assertThat(groupGrant.getSubjectId()).isEqualTo(4);
    }

    @Test
    public void equalsIsBasedOnIdOnly() {
        // not sure why it is this way but it is how it was coded ...
        final GroupGrant groupGrant = new GroupGrant(123L, 4);
        assertThat(groupGrant.equals(new GroupGrant(123L, 6))).isTrue();
        assertThat(groupGrant.equals(new GroupGrant(201L, 4))).isFalse();
    }

    @Test
    public void itShouldSerialize() throws IOException {
        final ObjectMapper mapper = new ObjectMapper();

        final String value = mapper.writeValueAsString(new GroupGrant(123L, 4));

        final GroupGrant unwrapped = mapper.readValue(value, GroupGrant.class);
        assertThat(unwrapped.getId()).isEqualTo(123);
        assertThat(unwrapped.getSubjectId()).isEqualTo(4);
    }
}
